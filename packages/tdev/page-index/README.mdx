---
page_id: cfbd9607-c2d5-4c2a-82e0-9f39c5756747
tags:
  - '@tdev/'
---

import { useStore } from '@tdev-hooks/useStore'
import { observer } from 'mobx-react-lite';
import CodeBlock from '@theme/CodeBlock';

# page-index

Dieses Plugin ermöglicht eine Übersicht über alle speicherbaren Dokumente. So kann bspw. der Bearbeitungsstand in der Seitenleiste angezeigt werden.

## Page index

Der Seitenindex ist ein Baum aller speicherbaren Dokumente in der aktuellen Seite.

Im `dev`-Modus wird er automatisch aktualisiert, wenn sich die Seite ändert.

:::details[Page Index]
export const Comp = observer(() => {
    const pageStore = useStore('pageStore');

    return (
        <div>
            <CodeBlock language="json">{JSON.stringify(pageStore.tree, null, 2)}</CodeBlock>;
        </div>
    );
});

<Comp />
:::

## Installation

:::info[`docusaurus.config.ts`]
```ts
import pageIndexPlugin from './packages/tdev/page-index/plugin';

export default {
    // ...
    plugins: [
        // ...
        pageIndexPlugin
    ]
};

```
:::


:::details[remark config]
```ts
import pageProgressStatePlugin from '@tdev/page-index/remark-plugin';

export const pageProgressStatePluginConfig = [
    pageProgressStatePlugin,
    {
        /**
         * Dynamische Komponenten, die im Seitenindex erfasst werden sollen.
         */
        components: [
            {
                name: 'Answer',
                docTypeExtractor: (node: MdxJsxFlowElement) =>
                    getAnswerDocumentType(
                        node.attributes.find((a) => a.type === 'mdxJsxAttribute' && a.name === 'type')
                            ?.value as string
                    ) || 'unknown'
            },
            {
                name: 'ProgressState',
                docTypeExtractor: () => 'progress_state'
            },
            {
                name: 'TaskState',
                docTypeExtractor: () => 'task_state'
            },
            {
                name: 'QuillV2',
                docTypeExtractor: () => 'quill_v2'
            },
            {
                name: 'String',
                docTypeExtractor: () => 'string'
            },
            {
                name: 'CmsText',
                docTypeExtractor: () => 'cms_text'
            },
            {
                name: 'CmsCode',
                docTypeExtractor: () => 'cms_text'
            },
            {
                name: 'Restricted',
                docTypeExtractor: () => 'restricted'
            },
            {
                name: 'DynamicDocumentRoots',
                docTypeExtractor: () => 'dynamic_document_roots'
            }
        ],
        /**
         * Code-Blöcke mit persistierten Inhalten, die im Seitenindex erfasst werden sollen.
         */
        persistedCodeType: (node: Code) => {
            if (node.lang === 'html') {
                return 'script';
            }
            const liveLangMatch = /(live_[a-zA-Z0-9-_]+)/.exec(node.meta || '');
            const liveCode = liveLangMatch ? liveLangMatch[1] : null;

            switch (liveCode) {
                case 'live_py':
                case 'live_bry':
                    // legacy name, TODO. should be 'brython_code'?
                    return 'script';
                case 'live_pyo':
                    return 'pyodide_code';
                default:
                    return 'code';
            }
        }
    }
];
```
:::